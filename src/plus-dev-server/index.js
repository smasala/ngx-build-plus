"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@angular-devkit/core");
const path = require("path");
const build_angular_1 = require("@angular-devkit/build-angular");
const webpackMerge = require('webpack-merge');
class DevServerBuilder extends build_angular_1.DevServerBuilder {
    buildWebpackConfig(root, projectRoot, host, browserOptions) {
        let config = super.buildWebpackConfig(root, projectRoot, host, browserOptions);
        if (browserOptions.singleBundle) {
            delete config.entry.polyfills;
            delete config.entry.styles;
            delete config.optimization;
        }
        if (browserOptions.singleBundle && browserOptions.bundleStyles !== false) {
            delete config.entry.styles;
        }
        if (browserOptions.extraWebpackConfig) {
            const filePath = path.resolve(core_1.getSystemPath(projectRoot), browserOptions.extraWebpackConfig);
            const additionalConfig = require(filePath);
            config = webpackMerge([config, additionalConfig]);
        }
        return config;
    }
}
exports.DevServerBuilder = DevServerBuilder;
exports.default = DevServerBuilder;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiRDovZGV2L3JlcG9zL25neC1idWlsZC1wbHVzL2xpYi8iLCJzb3VyY2VzIjpbInNyYy9wbHVzLWRldi1zZXJ2ZXIvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSwrQ0FBc0U7QUFDdEUsNkJBQTZCO0FBRzdCLGlFQUE2STtBQUM3SSxNQUFNLFlBQVksR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7QUFROUMsc0JBQThCLFNBQVEsZ0NBQW9CO0lBRXhELGtCQUFrQixDQUFDLElBQVUsRUFBRSxXQUFpQixFQUFFLElBQThCLEVBQUUsY0FBb0M7UUFFcEgsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDLGtCQUFrQixDQUFDLElBQUksRUFBRSxXQUFXLEVBQUUsSUFBSSxFQUFFLGNBQWMsQ0FBQyxDQUFDO1FBRS9FLElBQUksY0FBYyxDQUFDLFlBQVksRUFBRTtZQUMvQixPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDO1lBQzlCLE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7WUFDM0IsT0FBTyxNQUFNLENBQUMsWUFBWSxDQUFDO1NBQzVCO1FBRUQsSUFBSSxjQUFjLENBQUMsWUFBWSxJQUFJLGNBQWMsQ0FBQyxZQUFZLEtBQUssS0FBSyxFQUFFO1lBQ3hFLE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7U0FDNUI7UUFFRCxJQUFJLGNBQWMsQ0FBQyxrQkFBa0IsRUFBRTtZQUNyQyxNQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLG9CQUFhLENBQUMsV0FBVyxDQUFDLEVBQUUsY0FBYyxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDN0YsTUFBTSxnQkFBZ0IsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDM0MsTUFBTSxHQUFHLFlBQVksQ0FBQyxDQUFDLE1BQU0sRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7U0FDbkQ7UUFFRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0NBQ0Y7QUF4QkQsNENBd0JDO0FBRUQsa0JBQWUsZ0JBQWdCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYXRoLCBnZXRTeXN0ZW1QYXRoLCB2aXJ0dWFsRnMgfSBmcm9tICdAYW5ndWxhci1kZXZraXQvY29yZSc7XHJcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XHJcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJztcclxuXHJcbmltcG9ydCB7IERldlNlcnZlckJ1aWxkZXIgYXMgRGV2U2VydmVyQnVpbGRlckJhc2UsIEJyb3dzZXJCdWlsZGVyU2NoZW1hIGFzIEJyb3dzZXJCdWlsZGVyU2NoZW1hQmFzZSAgIH0gZnJvbSAnQGFuZ3VsYXItZGV2a2l0L2J1aWxkLWFuZ3VsYXInO1xyXG5jb25zdCB3ZWJwYWNrTWVyZ2UgPSByZXF1aXJlKCd3ZWJwYWNrLW1lcmdlJyk7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEJyb3dzZXJCdWlsZGVyU2NoZW1hIGV4dGVuZHMgQnJvd3NlckJ1aWxkZXJTY2hlbWFCYXNlIHtcclxuICBleHRyYVdlYnBhY2tDb25maWc6IHN0cmluZztcclxuICBzaW5nbGVCdW5kbGU6IGJvb2xlYW47XHJcbiAgYnVuZGxlU3R5bGVzOiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgRGV2U2VydmVyQnVpbGRlciBleHRlbmRzIERldlNlcnZlckJ1aWxkZXJCYXNlIHtcclxuXHJcbiAgYnVpbGRXZWJwYWNrQ29uZmlnKHJvb3Q6IFBhdGgsIHByb2plY3RSb290OiBQYXRoLCBob3N0OiB2aXJ0dWFsRnMuSG9zdDxmcy5TdGF0cz4sIGJyb3dzZXJPcHRpb25zOiBCcm93c2VyQnVpbGRlclNjaGVtYSk6IGFueSB7XHJcbiAgICBcclxuICAgIGxldCBjb25maWcgPSBzdXBlci5idWlsZFdlYnBhY2tDb25maWcocm9vdCwgcHJvamVjdFJvb3QsIGhvc3QsIGJyb3dzZXJPcHRpb25zKTtcclxuXHJcbiAgICBpZiAoYnJvd3Nlck9wdGlvbnMuc2luZ2xlQnVuZGxlKSB7XHJcbiAgICAgIGRlbGV0ZSBjb25maWcuZW50cnkucG9seWZpbGxzO1xyXG4gICAgICBkZWxldGUgY29uZmlnLmVudHJ5LnN0eWxlcztcclxuICAgICAgZGVsZXRlIGNvbmZpZy5vcHRpbWl6YXRpb247XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGJyb3dzZXJPcHRpb25zLnNpbmdsZUJ1bmRsZSAmJiBicm93c2VyT3B0aW9ucy5idW5kbGVTdHlsZXMgIT09IGZhbHNlKSB7XHJcbiAgICAgIGRlbGV0ZSBjb25maWcuZW50cnkuc3R5bGVzO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpZiAoYnJvd3Nlck9wdGlvbnMuZXh0cmFXZWJwYWNrQ29uZmlnKSB7XHJcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKGdldFN5c3RlbVBhdGgocHJvamVjdFJvb3QpLCBicm93c2VyT3B0aW9ucy5leHRyYVdlYnBhY2tDb25maWcpO1xyXG4gICAgICBjb25zdCBhZGRpdGlvbmFsQ29uZmlnID0gcmVxdWlyZShmaWxlUGF0aCk7XHJcbiAgICAgIGNvbmZpZyA9IHdlYnBhY2tNZXJnZShbY29uZmlnLCBhZGRpdGlvbmFsQ29uZmlnXSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNvbmZpZztcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IERldlNlcnZlckJ1aWxkZXI7Il19